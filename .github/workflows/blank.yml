name: Manage Repository

on:
  workflow_dispatch:
    inputs:
      repository_name:
        description: 'The name of the repository to create or delete'
        required: true
      action:
        description: 'Action to perform: create or delete'
        required: true
        type: choice
        default: 'create'
        options:
          - create
          - delete

jobs:
  manage-repo:
    runs-on: ubuntu-latest
    steps:
    - name: Check action type
      id: action_type
      run: echo "ACTION_TYPE=${{ github.event.inputs.action }}" >> $GITHUB_OUTPUT

    - name: Create Repository
      if: ${{ steps.action_type.outputs.ACTION_TYPE == 'create' }}
      run: |
        curl -X POST -H "Authorization: token ${{ secrets.TOKEN }}" \
        -H "Accept: application/vnd.github.v3+json" \
        https://api.github.com/orgs/FathAllaTechOps/repos \
        -d "{\"name\":\"${{ github.event.inputs.repository_name }}\"}"

    - name: Delete Repository
      if: ${{ steps.action_type.outputs.ACTION_TYPE == 'delete' }}
      run: |
        curl -X DELETE -H "Authorization: token ${{ secrets.TOKEN }}" \
        -H "Accept: application/vnd.github.v3+json" \
        https://api.github.com/repos/FathAllaTechOps/${{ github.event.inputs.repository_name }}
